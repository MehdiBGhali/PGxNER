Running on sh07
# conda environments:
#
base                  *  /opt/conda
PGx_env                  /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/PGx_env
PGx_env_37               /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/PGx_env_37
clean_PGx_env            /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/clean_PGx_env
clean_PGx_env_latest_transformers     /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/clean_PGx_env_latest_transformers
cloned_env               /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/cloned_env
new_PGx_env              /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env
torch_from_source_env     /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/torch_from_source_env

Namespace(bart_name='facebook/bart-large', batch_size=8, dataset_name='PGxCorpus', decoder_type='avg_feature', eval_start_epoch=10, history_dir='./training_history', length_penalty=1, lr=1e-05, max_len=10, max_len_a=1.1, n_epochs=100, num_beams=4, save_model=1, schedule='linear', target_type='bpe', use_encoder_mlp=1, warmup_ratio=0.01)
{'dev': +--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| entities     | entity_tags     | raw_words     | entity_spans     | tgt_tokens     | target_span     | src_tokens     | first       | src_seq_len | tgt_seq_len |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| [['COMT']... | ['gene_or_pr... | ['The', 'C... | [[1, 2], [1, ... | [0, 14, 15,... | [[14, 15, 2]... | [0, 20, 158... | [0, 1, 2... | 29          | 34          |
| [['tumors... | ['disease', ... | ['One', 'p... | [[5, 6], [7, ... | [0, 18, 6, ... | [[18, 6], [2... | [0, 509, 31... | [0, 1, 2... | 66          | 87          |
| [['DRD', ... | ['gene_or_pr... | ['CONCLUSI... | [[2, 4], [2, ... | [0, 17, 18,... | [[17, 18, 19... | [0, 8748, 2... | [0, 1, 2... | 33          | 31          |
| [['metabo... | ['chemical',... | ['To', 'id... | [[3, 6], [13,... | [0, 16, 17,... | [[16, 17, 18... | [0, 598, 30... | [0, 1, 2... | 43          | 39          |
| [['cytoch... | ['gene_or_pr... | ['As', 'cy... | [[1, 4], [6, ... | [0, 14, 15,... | [[14, 15, 16... | [0, 287, 19... | [0, 1, 2... | 47          | 33          |
| [['respon... | ['pharmacody... | ['The', 'r... | [[1, 3], [6, ... | [0, 14, 15,... | [[14, 15, 5]... | [0, 20, 126... | [0, 1, 2... | 26          | 25          |
| [['polymo... | ['limited_va... | ['With', '... | [[6, 11], [9,... | [0, 19, 20,... | [[19, 20, 21... | [0, 590, 62... | [0, 1, 2... | 59          | 39          |
| [['GNB', ... | ['gene_or_pr... | ['Patients... | [[3, 5], [3, ... | [0, 16, 17,... | [[16, 17, 18... | [0, 21755, ... | [0, 1, 2... | 43          | 22          |
| [['Sorafe... | ['chemical',... | ['Sorafeni... | [[0, 1], [8, ... | [0, 13, 14,... | [[13, 14, 15... | [0, 14405, ... | [0, 1, 2... | 55          | 41          |
| [['Gastri... | ['disease', ... | ['CONCLUSI... | [[2, 4], [6, ... | [0, 17, 18,... | [[17, 18, 19... | [0, 8748, 2... | [0, 1, 2... | 52          | 58          |
| [['Gly', ... | ['limited_va... | ['The', 'e... | [[4, 10], [7,... | [0, 17, 18,... | [[17, 18, 19... | [0, 20, 303... | [0, 1, 2... | 33          | 39          |
| [['geneti... | ['limited_va... | ['This', '... | [[6, 13], [10... | [0, 19, 20,... | [[19, 20, 21... | [0, 152, 89... | [0, 1, 2... | 33          | 34          |
| ...          | ...             | ...           | ...              | ...            | ...             | ...            | ...         | ...         | ...         |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+, 'test': +--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| entities     | entity_tags     | raw_words     | entity_spans     | tgt_tokens     | target_span     | src_tokens     | first       | src_seq_len | tgt_seq_len |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| [['alcoho... | ['chemical',... | ['Associat... | [[2, 3], [2, ... | [0, 15, 4, ... | [[15, 4], [1... | [0, 1544, 9... | [0, 1, 2... | 61          | 28          |
| [['GISTs'... | ['disease', ... | ['Most', '... | [[1, 2], [4, ... | [0, 14, 15,... | [[14, 15, 16... | [0, 1993, 2... | [0, 1, 2... | 40          | 23          |
| [['angiot... | ['gene_or_pr... | ['The', 'a... | [[1, 7], [1, ... | [0, 14, 15,... | [[14, 15, 16... | [0, 20, 566... | [0, 1, 2... | 50          | 58          |
| [['levels... | ['phenotype'... | ['The', 'l... | [[1, 6, 12, 1... | [0, 14, 15,... | [[14, 15, 16... | [0, 20, 138... | [0, 1, 2... | 55          | 71          |
| [['morphi... | ['chemical',... | ['Although... | [[1, 2], [1, ... | [0, 14, 4, ... | [[14, 4], [1... | [0, 2223, 3... | [0, 1, 2... | 29          | 23          |
| [['T', '1... | ['limited_va... | ['In', 'th... | [[9, 28], [15... | [0, 22, 23,... | [[22, 23, 24... | [0, 96, 5, ... | [0, 1, 2... | 39          | 44          |
| [['respon... | ['pharmacody... | ['This', '... | [[5, 8], [5, ... | [0, 18, 19,... | [[18, 19, 20... | [0, 152, 31... | [0, 1, 2... | 42          | 47          |
| [['AZ'], ... | ['chemical',... | ['However'... | [[9, 10], [12... | [0, 22, 4, ... | [[22, 4], [2... | [0, 635, 21... | [0, 1, 2... | 104         | 93          |
| [['lycope... | ['chemical',... | ['We', 'fo... | [[3, 4], [8, ... | [0, 16, 17,... | [[16, 17, 18... | [0, 166, 30... | [0, 1, 2... | 36          | 51          |
| [['Cytoch... | ['gene_or_pr... | ['Cytochro... | [[0, 6], [0, ... | [0, 13, 14,... | [[13, 14, 15... | [0, 9384, 5... | [0, 1, 2... | 45          | 79          |
| [['oral',... | ['pharmacoki... | ['We', 'fo... | [[2, 8], [5, ... | [0, 15, 16,... | [[15, 16, 17... | [0, 166, 30... | [0, 1, 2... | 62          | 40          |
| [['MDR', ... | ['gene_or_pr... | ['Is', 'th... | [[5, 7], [5, ... | [0, 18, 19,... | [[18, 19, 20... | [0, 1534, 8... | [0, 1, 2... | 38          | 43          |
| ...          | ...             | ...           | ...              | ...            | ...             | ...            | ...         | ...         | ...         |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+, 'train': +--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| entities     | entity_tags     | raw_words     | entity_spans     | tgt_tokens     | target_span     | src_tokens     | first       | src_seq_len | tgt_seq_len |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| [['UGT', ... | ['gene_or_pr... | ['CONCLUSI... | [[5, 9], [5, ... | [0, 20, 21,... | [[20, 21, 22... | [0, 8748, 2... | [0, 1, 2... | 40          | 46          |
| [['opioid... | ['chemical',... | ['Withdraw... | [[7, 9], [10,... | [0, 26, 27,... | [[26, 27, 4]... | [0, 590, 24... | [0, 1, 2... | 56          | 28          |
| [['effect... | ['pharmacody... | ['To', 'ad... | [[8, 15], [14... | [0, 21, 22,... | [[21, 22, 23... | [0, 598, 11... | [0, 1, 2... | 53          | 57          |
| [['PDAC']... | ['disease', ... | ['Accordin... | [[2, 3], [7, ... | [0, 15, 16,... | [[15, 16, 6]... | [0, 29129, ... | [0, 1, 2... | 35          | 40          |
| [['nonres... | ['pharmacody... | ['One', 'o... | [[3, 4], [7, ... | [0, 16, 17,... | [[16, 17, 18... | [0, 509, 9,... | [0, 1, 2... | 67          | 48          |
| [['Beta',... | ['gene_or_pr... | ['Beta', '... | [[0, 2], [0, ... | [0, 13, 14,... | [[13, 14, 2]... | [0, 25905, ... | [0, 1, 2... | 34          | 18          |
| [['multik... | ['chemical',... | ['Here', '... | [[6, 8], [8, ... | [0, 19, 20,... | [[19, 20, 21... | [0, 1398, 2... | [0, 1, 2... | 56          | 31          |
| [['DPYD']... | ['gene_or_pr... | ['The', 'a... | [[6, 7], [6, ... | [0, 19, 20,... | [[19, 20, 2]... | [0, 20, 410... | [0, 1, 2... | 43          | 27          |
| [['JAK', ... | ['gene_or_pr... | ['The', 'J... | [[1, 3], [1, ... | [0, 14, 15,... | [[14, 15, 16... | [0, 20, 344... | [0, 1, 2... | 74          | 76          |
| [['exons'... | ['genomic_fa... | ['METHODS'... | [[5, 9], [7, ... | [0, 21, 22,... | [[21, 22, 23... | [0, 256, 40... | [0, 1, 2... | 43          | 24          |
| [['GSTT',... | ['gene_or_pr... | ['Particul... | [[4, 6], [4, ... | [0, 17, 18,... | [[17, 18, 19... | [0, 36863, ... | [0, 1, 2... | 31          | 41          |
| [['CYP', ... | ['gene_or_pr... | ['The', 'e... | [[3, 7], [3, ... | [0, 16, 17,... | [[16, 17, 18... | [0, 20, 303... | [0, 1, 2... | 31          | 33          |
| ...          | ...             | ...           | ...              | ...            | ...             | ...            | ...         | ...         | ...         |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+}
Save cache to caches/data_facebook/bart-large_PGxCorpus_bpe.pt.
max_len_a:1.1, max_len:10
In total 3 datasets:
	dev has 75 instances.
	test has 76 instances.
	train has 567 instances.

50275 50280
cpu
11.3
input fields after batch(if batch size is 2):
	tgt_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 46]) 
	src_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 56]) 
	first: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 56]) 
	src_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
	tgt_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
target fields after batch(if batch size is 2):
	entities: (1)type:numpy.ndarray (2)dtype:object, (3)shape:(2,) 
	tgt_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 46]) 
	target_span: (1)type:numpy.ndarray (2)dtype:object, (3)shape:(2,) 
	tgt_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 

training epochs started 2023-02-21-20-39-20-187713
logging training to fitlog
creating history dir
[0, 3, 20, 5, 24, 16, 22, 2, 7, 17, 18, 21, 9, 23, 10, 15, 14, 4, 0, 1, 13, 12, 11, 6, 8, 19]

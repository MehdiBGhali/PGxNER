Running on sh04
# conda environments:
#
base                  *  /opt/conda
PGx_env                  /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/PGx_env
PGx_env_37               /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/PGx_env_37
new_PGx_env              /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env
torch_from_source_env     /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/torch_from_source_env

Namespace(bart_name='facebook/bart-large', batch_size=8, dataset_name='PGxCorpus', decoder_type='avg_feature', eval_start_epoch=10, history_dir='./training_history', length_penalty=1, lr=1e-05, max_len=10, max_len_a=1.1, n_epochs=100, num_beams=4, save_model=1, schedule='linear', target_type='word', use_encoder_mlp=1, warmup_ratio=0.01)
processing
29
66
33
43
47
26
59
43
55
52
33
33
45
30
43
31
21
37
38
88
38
54
49
47
27
49
28
36
78
36
83
36
68
67
49
66
49
66
24
98
31
85
54
23
45
34
30
47
16
42
58
53
87
69
24
21
87
23
25
26
51
95
25
66
40
42
26
48
33
26
31
51
49
37
37
61
40
50
55
29
39
42
104
36
45
62
38
50
35
23
24
26
42
38
38
57
58
61
65
49
34
33
38
39
95
69
42
43
22
43
51
66
129
62
65
35
49
33
49
29
57
35
105
32
35
57
96
54
43
91
56
32
29
34
27
59
53
90
41
33
32
36
29
39
31
68
34
39
36
45
29
40
56
53
35
67
34
56
43
74
43
31
31
38
42
36
75
40
67
30
74
20
27
29
31
88
146
67
60
33
45
89
53
56
38
60
72
39
32
35
30
62
31
58
45
45
57
55
38
30
36
39
37
64
39
39
64
47
56
65
38
75
48
37
68
51
61
34
56
31
73
58
126
58
48
39
23
44
50
46
40
37
34
26
42
35
38
24
42
46
27
28
42
18
90
91
26
47
33
61
37
41
40
33
43
44
29
81
55
32
53
113
42
31
29
60
109
77
65
58
69
40
66
41
63
145
50
60
86
41
23
56
38
33
57
37
62
70
38
52
39
19
56
28
33
52
31
27
68
49
42
34
51
34
50
42
36
35
37
37
31
55
23
43
30
40
40
37
50
61
84
27
49
37
23
51
45
43
46
36
34
38
87
43
24
39
33
68
36
109
47
33
87
63
35
35
80
39
55
84
77
25
73
31
44
37
35
52
33
47
21
40
55
27
70
88
74
54
53
21
62
35
72
60
47
67
28
40
56
37
39
71
30
53
38
23
32
65
36
54
27
29
28
38
41
76
23
53
46
32
46
37
51
63
49
124
46
39
28
40
118
61
44
119
55
37
25
74
37
60
45
49
82
44
59
30
39
25
52
32
81
41
39
47
158
57
33
74
21
63
54
64
47
39
50
54
38
36
27
46
37
39
57
32
79
34
48
26
39
31
34
81
46
34
47
45
20
30
68
20
56
63
43
59
23
51
42
38
54
45
42
46
33
35
49
27
49
60
112
51
33
54
57
57
53
29
71
28
64
53
35
104
70
35
39
36
40
72
70
64
42
45
80
117
58
30
50
36
41
84
27
48
48
70
41
32
52
30
23
24
16
55
68
30
57
56
24
30
31
26
33
60
33
27
82
36
75
60
30
61
79
46
42
38
53
56
50
41
61
45
22
52
72
39
52
35
36
61
62
26
40
35
28
29
46
41
78
53
44
40
35
35
40
48
39
25
43
42
82
48
56
37
34
56
66
70
37
99
36
61
56
74
32
55
34
200
64
31
58
23
66
34
23
37
33
43
67
75
35
87
50
66
47
64
23
54
56
22
61
28
57
81
19
60
73
53
54
46
38
71
49
37
21
45
33
72
161
34
53
44
78
55
81
77
27
26
43
61
69
40
63
25
45
37
88
44
128
63
53
72
84
30
38
41
53
63
38
52
63
47
61
48
34
68
103
46
41
33
48
39
22
38
44
76
50
41
38
91
63
70
38
40
67
22
37
68
84
42
42
71
53
46
24
32
39
15
27
53
{'dev': +--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| entities     | entity_tags     | raw_words     | entity_spans     | tgt_tokens     | target_span     | src_tokens     | first       | src_seq_len | tgt_seq_len |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| [['COMT']... | ['gene_or_pr... | ['The', 'C... | [[1, 2], [1, ... | [0, 14, 2, ... | [[14, 2], [1... | [0, 20, 158... | [0, 1, 2... | 29          | 21          |
| [['tumors... | ['disease', ... | ['One', 'p... | [[5, 6], [7, ... | [0, 18, 6, ... | [[18, 6], [2... | [0, 509, 31... | [0, 1, 2... | 66          | 71          |
| [['DRD', ... | ['gene_or_pr... | ['CONCLUSI... | [[2, 4], [2, ... | [0, 17, 19,... | [[17, 19, 2]... | [0, 8748, 2... | [0, 1, 2... | 33          | 20          |
| [['metabo... | ['chemical',... | ['To', 'id... | [[3, 6], [13,... | [0, 16, 17,... | [[16, 17, 18... | [0, 598, 30... | [0, 1, 2... | 43          | 33          |
| [['cytoch... | ['gene_or_pr... | ['As', 'cy... | [[1, 4], [6, ... | [0, 14, 17,... | [[14, 17, 18... | [0, 287, 19... | [0, 1, 2... | 47          | 25          |
| [['respon... | ['pharmacody... | ['The', 'r... | [[1, 3], [6, ... | [0, 14, 15,... | [[14, 15, 5]... | [0, 20, 126... | [0, 1, 2... | 26          | 20          |
| [['polymo... | ['limited_va... | ['With', '... | [[6, 11], [9,... | [0, 19, 21,... | [[19, 21, 22... | [0, 590, 62... | [0, 1, 2... | 59          | 22          |
| [['GNB', ... | ['gene_or_pr... | ['Patients... | [[3, 5], [3, ... | [0, 16, 18,... | [[16, 18, 2]... | [0, 21755, ... | [0, 1, 2... | 43          | 17          |
| [['Sorafe... | ['chemical',... | ['Sorafeni... | [[0, 1], [8, ... | [0, 13, 4, ... | [[13, 4], [2... | [0, 14405, ... | [0, 1, 2... | 55          | 33          |
| [['Gastri... | ['disease', ... | ['CONCLUSI... | [[2, 4], [6, ... | [0, 17, 19,... | [[17, 19, 6]... | [0, 8748, 2... | [0, 1, 2... | 52          | 41          |
| [['Gly', ... | ['limited_va... | ['The', 'e... | [[4, 10], [7,... | [0, 17, 18,... | [[17, 18, 19... | [0, 20, 303... | [0, 1, 2... | 33          | 26          |
| [['geneti... | ['limited_va... | ['This', '... | [[6, 13], [10... | [0, 19, 20,... | [[19, 20, 21... | [0, 152, 89... | [0, 1, 2... | 33          | 25          |
| ...          | ...             | ...           | ...              | ...            | ...             | ...            | ...         | ...         | ...         |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+, 'test': +--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| entities     | entity_tags     | raw_words     | entity_spans     | tgt_tokens     | target_span     | src_tokens     | first       | src_seq_len | tgt_seq_len |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| [['alcoho... | ['chemical',... | ['Associat... | [[2, 3], [2, ... | [0, 15, 4, ... | [[15, 4], [1... | [0, 1544, 9... | [0, 1, 2... | 61          | 22          |
| [['GISTs'... | ['disease', ... | ['Most', '... | [[1, 2], [4, ... | [0, 14, 6, ... | [[14, 6], [1... | [0, 1993, 2... | [0, 1, 2... | 40          | 13          |
| [['angiot... | ['gene_or_pr... | ['The', 'a... | [[1, 7], [1, ... | [0, 14, 18,... | [[14, 18, 19... | [0, 20, 566... | [0, 1, 2... | 50          | 41          |
| [['levels... | ['phenotype'... | ['The', 'l... | [[1, 6, 12, 1... | [0, 14, 15,... | [[14, 15, 16... | [0, 20, 138... | [0, 1, 2... | 55          | 53          |
| [['morphi... | ['chemical',... | ['Although... | [[1, 2], [1, ... | [0, 14, 4, ... | [[14, 4], [1... | [0, 2223, 3... | [0, 1, 2... | 29          | 21          |
| [['T', '1... | ['limited_va... | ['In', 'th... | [[9, 28], [15... | [0, 22, 23,... | [[22, 23, 24... | [0, 96, 5, ... | [0, 1, 2... | 39          | 39          |
| [['respon... | ['pharmacody... | ['This', '... | [[5, 8], [5, ... | [0, 18, 19,... | [[18, 19, 20... | [0, 152, 31... | [0, 1, 2... | 42          | 31          |
| [['AZ'], ... | ['chemical',... | ['However'... | [[9, 10], [12... | [0, 22, 4, ... | [[22, 4], [2... | [0, 635, 21... | [0, 1, 2... | 104         | 77          |
| [['lycope... | ['chemical',... | ['We', 'fo... | [[3, 4], [8, ... | [0, 16, 4, ... | [[16, 4], [2... | [0, 166, 30... | [0, 1, 2... | 36          | 39          |
| [['Cytoch... | ['gene_or_pr... | ['Cytochro... | [[0, 6], [0, ... | [0, 13, 16,... | [[13, 16, 17... | [0, 9384, 5... | [0, 1, 2... | 45          | 51          |
| [['oral',... | ['pharmacoki... | ['We', 'fo... | [[2, 8], [5, ... | [0, 15, 16,... | [[15, 16, 17... | [0, 166, 30... | [0, 1, 2... | 62          | 28          |
| [['MDR', ... | ['gene_or_pr... | ['Is', 'th... | [[5, 7], [5, ... | [0, 18, 20,... | [[18, 20, 2]... | [0, 1534, 8... | [0, 1, 2... | 38          | 33          |
| ...          | ...             | ...           | ...              | ...            | ...             | ...            | ...         | ...         | ...         |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+, 'train': +--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| entities     | entity_tags     | raw_words     | entity_spans     | tgt_tokens     | target_span     | src_tokens     | first       | src_seq_len | tgt_seq_len |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| [['UGT', ... | ['gene_or_pr... | ['CONCLUSI... | [[5, 9], [5, ... | [0, 20, 22,... | [[20, 22, 23... | [0, 8748, 2... | [0, 1, 2... | 40          | 34          |
| [['opioid... | ['chemical',... | ['Withdraw... | [[7, 9], [10,... | [0, 26, 27,... | [[26, 27, 4]... | [0, 590, 24... | [0, 1, 2... | 56          | 18          |
| [['effect... | ['pharmacody... | ['To', 'ad... | [[8, 15], [14... | [0, 21, 22,... | [[21, 22, 23... | [0, 598, 11... | [0, 1, 2... | 53          | 56          |
| [['PDAC']... | ['disease', ... | ['Accordin... | [[2, 3], [7, ... | [0, 15, 6, ... | [[15, 6], [2... | [0, 29129, ... | [0, 1, 2... | 35          | 31          |
| [['nonres... | ['pharmacody... | ['One', 'o... | [[3, 4], [7, ... | [0, 16, 5, ... | [[16, 5], [2... | [0, 509, 9,... | [0, 1, 2... | 67          | 38          |
| [['Beta',... | ['gene_or_pr... | ['Beta', '... | [[0, 2], [0, ... | [0, 13, 14,... | [[13, 14, 2]... | [0, 25905, ... | [0, 1, 2... | 34          | 17          |
| [['multik... | ['chemical',... | ['Here', '... | [[6, 8], [8, ... | [0, 19, 23,... | [[19, 23, 4]... | [0, 1398, 2... | [0, 1, 2... | 56          | 19          |
| [['DPYD']... | ['gene_or_pr... | ['The', 'a... | [[6, 7], [6, ... | [0, 19, 2, ... | [[19, 2], [1... | [0, 20, 410... | [0, 1, 2... | 43          | 22          |
| [['JAK', ... | ['gene_or_pr... | ['The', 'J... | [[1, 3], [1, ... | [0, 14, 16,... | [[14, 16, 2]... | [0, 20, 344... | [0, 1, 2... | 74          | 55          |
| [['exons'... | ['genomic_fa... | ['METHODS'... | [[5, 9], [7, ... | [0, 21, 23,... | [[21, 23, 24... | [0, 256, 40... | [0, 1, 2... | 43          | 17          |
| [['GSTT',... | ['gene_or_pr... | ['Particul... | [[4, 6], [4, ... | [0, 17, 19,... | [[17, 19, 2]... | [0, 36863, ... | [0, 1, 2... | 31          | 31          |
| [['CYP', ... | ['gene_or_pr... | ['The', 'e... | [[3, 7], [3, ... | [0, 16, 18,... | [[16, 18, 19... | [0, 20, 303... | [0, 1, 2... | 31          | 28          |
| ...          | ...             | ...           | ...              | ...            | ...             | ...            | ...         | ...         | ...         |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+}
Save cache to caches/data_facebook/bart-large_PGxCorpus_word.pt.
max_len_a:1.1, max_len:10
In total 3 datasets:
	dev has 75 instances.
	test has 76 instances.
	train has 567 instances.

The number of tokens in tokenizer  50265
50275 50280
cpu
11.3
input fields after batch(if batch size is 2):
	tgt_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 34]) 
	src_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 56]) 
	first: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 56]) 
	src_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
	tgt_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
target fields after batch(if batch size is 2):
	entities: (1)type:numpy.ndarray (2)dtype:object, (3)shape:(2,) 
	tgt_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 34]) 
	target_span: (1)type:numpy.ndarray (2)dtype:object, (3)shape:(2,) 
	tgt_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 

training epochs started 2023-02-20-18-24-19-055501
logging training to fitlog
creating history dir
[0, 3, 5, 16, 2, 7, 17, 9, 10, 15, 14, 4, 0, 1, 13, 12, 11, 6, 8]

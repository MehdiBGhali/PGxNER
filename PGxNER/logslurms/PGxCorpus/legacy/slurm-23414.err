pre. tgt. for `dev`:   0%|          | 0/75 [00:00<?, ?it/s]pre. tgt. for `dev`:  64%|██████▍   | 48/75 [00:00<00:00, 473.95it/s]                                                                     pre. tgt. for `test`:   0%|          | 0/76 [00:00<?, ?it/s]pre. tgt. for `test`:  66%|██████▌   | 50/76 [00:00<00:00, 494.61it/s]                                                                      pre. tgt. for `train`:   0%|          | 0/567 [00:00<?, ?it/s]pre. tgt. for `train`:   9%|▊         | 49/567 [00:00<00:01, 486.42it/s]pre. tgt. for `train`:  18%|█▊        | 103/567 [00:00<00:00, 498.84it/s]pre. tgt. for `train`:  27%|██▋       | 151/567 [00:00<00:00, 491.31it/s]pre. tgt. for `train`:  36%|███▋      | 206/567 [00:00<00:00, 507.49it/s]pre. tgt. for `train`:  46%|████▌     | 260/567 [00:00<00:00, 511.29it/s]pre. tgt. for `train`:  55%|█████▍    | 311/567 [00:00<00:00, 509.21it/s]pre. tgt. for `train`:  64%|██████▍   | 363/567 [00:00<00:00, 509.36it/s]pre. tgt. for `train`:  74%|███████▎  | 418/567 [00:00<00:00, 520.22it/s]pre. tgt. for `train`:  83%|████████▎ | 470/567 [00:00<00:00, 519.78it/s]pre. tgt. for `train`:  92%|█████████▏| 521/567 [00:01<00:00, 507.23it/s]                                                                           0%|          | 0/355 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/5:   0%|          | 0/355 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/5:   0%|          | 1/355 [00:04<26:44,  4.53s/it, loss:{0:<6.5f}]Epoch 1/5:   0%|          | 1/355 [00:04<26:44,  4.53s/it, loss:9.21288]  Epoch 1/5:   1%|          | 2/355 [00:10<28:55,  4.92s/it, loss:9.21288]Epoch 1/5:   1%|          | 2/355 [00:10<28:55,  4.92s/it, loss:6.25516]Epoch 1/5:   1%|          | 3/355 [00:13<25:17,  4.31s/it, loss:6.25516]Epoch 1/5:   1%|          | 3/355 [00:13<25:17,  4.31s/it, loss:9.75575]Epoch 1/5:   1%|          | 4/355 [00:16<23:56,  4.09s/it, loss:9.75575]Epoch 1/5:   1%|          | 4/355 [00:16<23:56,  4.09s/it, loss:5.37442]Epoch 1/5:   1%|▏         | 5/355 [00:19<21:46,  3.73s/it, loss:5.37442]Epoch 1/5:   1%|▏         | 5/355 [00:19<21:46,  3.73s/it, loss:4.80552]Epoch 1/5:   2%|▏         | 6/355 [00:22<19:11,  3.30s/it, loss:4.80552]Epoch 1/5:   2%|▏         | 6/355 [00:22<19:11,  3.30s/it, loss:4.58654]Epoch 1/5:   2%|▏         | 7/355 [00:25<18:56,  3.26s/it, loss:4.58654]Epoch 1/5:   2%|▏         | 7/355 [00:25<18:56,  3.26s/it, loss:4.72433]Epoch 1/5:   2%|▏         | 8/355 [00:27<17:20,  3.00s/it, loss:4.72433]Epoch 1/5:   2%|▏         | 8/355 [00:27<17:20,  3.00s/it, loss:4.80130]Epoch 1/5:   3%|▎         | 9/355 [00:30<17:19,  3.01s/it, loss:4.80130]Epoch 1/5:   3%|▎         | 9/355 [00:30<17:19,  3.01s/it, loss:4.65139]Epoch 1/5:   3%|▎         | 10/355 [00:33<16:56,  2.95s/it, loss:4.65139]Epoch 1/5:   3%|▎         | 10/355 [00:33<16:56,  2.95s/it, loss:4.25946]Epoch 1/5:   3%|▎         | 11/355 [00:36<17:23,  3.03s/it, loss:4.25946]Epoch 1/5:   3%|▎         | 11/355 [00:36<17:23,  3.03s/it, loss:4.14061]Epoch 1/5:   3%|▎         | 12/355 [00:39<16:22,  2.87s/it, loss:4.14061]Epoch 1/5:   3%|▎         | 12/355 [00:39<16:22,  2.87s/it, loss:4.39555]Epoch 1/5:   4%|▎         | 13/355 [00:41<15:17,  2.68s/it, loss:4.39555]Epoch 1/5:   4%|▎         | 13/355 [00:41<15:17,  2.68s/it, loss:4.69270]Epoch 1/5:   4%|▍         | 14/355 [00:43<14:28,  2.55s/it, loss:4.69270]Epoch 1/5:   4%|▍         | 14/355 [00:43<14:28,  2.55s/it, loss:4.10244]Epoch 1/5:   4%|▍         | 15/355 [00:47<16:00,  2.82s/it, loss:4.10244]Epoch 1/5:   4%|▍         | 15/355 [00:47<16:00,  2.82s/it, loss:4.37274]Epoch 1/5:   5%|▍         | 16/355 [00:49<15:12,  2.69s/it, loss:4.37274]Epoch 1/5:   5%|▍         | 16/355 [00:49<15:12,  2.69s/it, loss:3.98797]Epoch 1/5:   5%|▍         | 17/355 [00:52<15:05,  2.68s/it, loss:3.98797]Epoch 1/5:   5%|▍         | 17/355 [00:52<15:05,  2.68s/it, loss:3.54457]Epoch 1/5:   5%|▌         | 18/355 [00:54<15:09,  2.70s/it, loss:3.54457]Epoch 1/5:   5%|▌         | 18/355 [00:54<15:09,  2.70s/it, loss:3.72531]Epoch 1/5:   5%|▌         | 19/355 [00:57<15:45,  2.81s/it, loss:3.72531]Epoch 1/5:   5%|▌         | 19/355 [00:57<15:45,  2.81s/it, loss:3.99497]Epoch 1/5:   6%|▌         | 20/355 [01:00<15:37,  2.80s/it, loss:3.99497]Epoch 1/5:   6%|▌         | 20/355 [01:00<15:37,  2.80s/it, loss:3.92471]Epoch 1/5:   6%|▌         | 21/355 [01:05<18:09,  3.26s/it, loss:3.92471]Epoch 1/5:   6%|▌         | 21/355 [01:05<18:09,  3.26s/it, loss:4.10468]Epoch 1/5:   6%|▌         | 22/355 [01:07<16:43,  3.01s/it, loss:4.10468]Epoch 1/5:   6%|▌         | 22/355 [01:07<16:43,  3.01s/it, loss:3.57066]Epoch 1/5:   6%|▋         | 23/355 [01:09<15:09,  2.74s/it, loss:3.57066]Epoch 1/5:   6%|▋         | 23/355 [01:09<15:09,  2.74s/it, loss:3.44032]Epoch 1/5:   7%|▋         | 24/355 [01:12<14:50,  2.69s/it, loss:3.44032]Epoch 1/5:   7%|▋         | 24/355 [01:12<14:50,  2.69s/it, loss:3.53681]Epoch 1/5:   7%|▋         | 25/355 [01:14<14:26,  2.63s/it, loss:3.53681]Epoch 1/5:   7%|▋         | 25/355 [01:14<14:26,  2.63s/it, loss:3.36753]Epoch 1/5:   7%|▋         | 26/355 [01:17<14:03,  2.56s/it, loss:3.36753]Epoch 1/5:   7%|▋         | 26/355 [01:17<14:03,  2.56s/it, loss:3.77154]Epoch 1/5:   8%|▊         | 27/355 [01:19<14:14,  2.61s/it, loss:3.77154]Epoch 1/5:   8%|▊         | 27/355 [01:19<14:14,  2.61s/it, loss:3.68558]Epoch 1/5:   8%|▊         | 28/355 [01:22<14:22,  2.64s/it, loss:3.68558]Epoch 1/5:   8%|▊         | 28/355 [01:22<14:22,  2.64s/it, loss:3.42100]Epoch 1/5:   8%|▊         | 29/355 [01:25<14:55,  2.75s/it, loss:3.42100]Epoch 1/5:   8%|▊         | 29/355 [01:25<14:55,  2.75s/it, loss:3.45024]Epoch 1/5:   8%|▊         | 30/355 [01:28<14:50,  2.74s/it, loss:3.45024]Epoch 1/5:   8%|▊         | 30/355 [01:28<14:50,  2.74s/it, loss:3.43506]Epoch 1/5:   9%|▊         | 31/355 [01:30<14:00,  2.59s/it, loss:3.43506]Epoch 1/5:   9%|▊         | 31/355 [01:30<14:00,  2.59s/it, loss:3.60753]Epoch 1/5:   9%|▉         | 32/355 [01:34<15:39,  2.91s/it, loss:3.60753]Epoch 1/5:   9%|▉         | 32/355 [01:34<15:39,  2.91s/it, loss:3.51310]Epoch 1/5:   9%|▉         | 33/355 [01:36<14:59,  2.79s/it, loss:3.51310]Epoch 1/5:   9%|▉         | 33/355 [01:36<14:59,  2.79s/it, loss:3.03238]Epoch 1/5:  10%|▉         | 34/355 [01:41<18:15,  3.41s/it, loss:3.03238]Epoch 1/5:  10%|▉         | 34/355 [01:41<18:15,  3.41s/it, loss:3.67016]Epoch 1/5:  10%|▉         | 35/355 [01:44<17:19,  3.25s/it, loss:3.67016]Epoch 1/5:  10%|▉         | 35/355 [01:44<17:19,  3.25s/it, loss:3.17485]Epoch 1/5:  10%|█         | 36/355 [01:48<18:06,  3.41s/it, loss:3.17485]Epoch 1/5:  10%|█         | 36/355 [01:48<18:06,  3.41s/it, loss:3.42866]Epoch 1/5:  10%|█         | 37/355 [01:51<18:14,  3.44s/it, loss:3.42866]Epoch 1/5:  10%|█         | 37/355 [01:51<18:14,  3.44s/it, loss:3.32805]Epoch 1/5:  11%|█         | 38/355 [01:55<18:45,  3.55s/it, loss:3.32805]Epoch 1/5:  11%|█         | 38/355 [01:55<18:45,  3.55s/it, loss:3.22226]Epoch 1/5:  11%|█         | 39/355 [01:58<17:43,  3.37s/it, loss:3.22226]Epoch 1/5:  11%|█         | 39/355 [01:58<17:43,  3.37s/it, loss:3.30511]Epoch 1/5:  11%|█▏        | 40/355 [02:02<19:36,  3.73s/it, loss:3.30511]Epoch 1/5:  11%|█▏        | 40/355 [02:02<19:36,  3.73s/it, loss:3.36148]Epoch 1/5:  12%|█▏        | 41/355 [02:06<18:30,  3.54s/it, loss:3.36148]Epoch 1/5:  12%|█▏        | 41/355 [02:06<18:30,  3.54s/it, loss:3.13334]Epoch 1/5:  12%|█▏        | 42/355 [02:08<16:08,  3.09s/it, loss:3.13334]Epoch 1/5:  12%|█▏        | 42/355 [02:08<16:08,  3.09s/it, loss:2.74158]Epoch 1/5:  12%|█▏        | 43/355 [02:10<14:39,  2.82s/it, loss:2.74158]Epoch 1/5:  12%|█▏        | 43/355 [02:10<14:39,  2.82s/it, loss:2.84481]Epoch 1/5:  12%|█▏        | 44/355 [02:13<15:04,  2.91s/it, loss:2.84481]Epoch 1/5:  12%|█▏        | 44/355 [02:13<15:04,  2.91s/it, loss:2.93699]Epoch 1/5:  13%|█▎        | 45/355 [02:15<14:05,  2.73s/it, loss:2.93699]Epoch 1/5:  13%|█▎        | 45/355 [02:15<14:05,  2.73s/it, loss:2.74174]Epoch 1/5:  13%|█▎        | 46/355 [02:18<13:23,  2.60s/it, loss:2.74174]Epoch 1/5:  13%|█▎        | 46/355 [02:18<13:23,  2.60s/it, loss:2.76038]Epoch 1/5:  13%|█▎        | 47/355 [02:21<14:12,  2.77s/it, loss:2.76038]Epoch 1/5:  13%|█▎        | 47/355 [02:21<14:12,  2.77s/it, loss:3.43525]Epoch 1/5:  14%|█▎        | 48/355 [02:24<15:08,  2.96s/it, loss:3.43525]Epoch 1/5:  14%|█▎        | 48/355 [02:24<15:08,  2.96s/it, loss:3.07991]Epoch 1/5:  14%|█▍        | 49/355 [02:26<13:45,  2.70s/it, loss:3.07991]Epoch 1/5:  14%|█▍        | 49/355 [02:26<13:45,  2.70s/it, loss:2.41821]                                                                         Traceback (most recent call last):
  File "./BARTNER/train.py", line 332, in <module>
    trainer.train(load_best_model=False)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/trainer.py", line 667, in train
    raise e
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/trainer.py", line 658, in train
    self._train()
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/trainer.py", line 728, in _train
    self.callback_manager.on_backward_begin(loss)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/callback.py", line 322, in wrapper
    returns.append(getattr(callback, func.__name__)(*arg))
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/callbacks.py", line 326, in on_backward_begin
    train_losses.write(f"{self._avg_loss /self._log_loss_every *self.update_every} \n")
NameError: name 'train_losses' is not defined
Traceback (most recent call last):
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/bin/fitlog", line 8, in <module>
    sys.exit(main_cmd())
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fitlog/fastcmd/__init__.py", line 49, in main_cmd
    cmd_map[cmd](argv)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fitlog/fastcmd/log_cmd.py", line 52, in log_cmd
    start_app(log_dir, log_config_name, start_port, standby_hours, ip, token)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fitlog/fastserver/app.py", line 93, in start_app
    all_data.update(prepare_data(log_reader, all_data['root_log_dir'], all_data['log_config_name']))
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fitlog/fastserver/server/table_utils.py", line 394, in prepare_data
    logs, configs, extra_data = get_log_and_extra_based_on_config(log_reader, log_dir, log_config_name)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fitlog/fastserver/server/table_utils.py", line 340, in get_log_and_extra_based_on_config
    log_reader.set_log_dir(log_dir)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fitlog/fastlog/log_read.py", line 35, in set_log_dir
    raise RuntimeError("`{}` has no valid logs. You should run your program first.".format(log_dir))
RuntimeError: `/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/Fitlog/logs` has no valid logs. You should run your program first.

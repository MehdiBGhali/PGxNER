Running on sh02
# conda environments:
#
base                  *  /opt/conda
PGx_env                  /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/PGx_env
PGx_env_37               /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/PGx_env_37
new_PGx_env              /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env
torch_from_source_env     /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/torch_from_source_env

Namespace(bart_name='facebook/bart-large', batch_size=8, dataset_name='PGxCorpus', decoder_type='avg_feature', eval_start_epoch=10, history_dir='./training_history', length_penalty=1, lr=1e-05, max_len=10, max_len_a=1.0, n_epochs=80, num_beams=3, save_model=1, schedule='linear', target_type='word', use_encoder_mlp=1, warmup_ratio=0.01)
Save cache to caches/data_facebook/bart-large_PGxCorpus_word.pt.
max_len_a:1.0, max_len:10
In total 3 datasets:
	dev has 75 instances.
	test has 76 instances.
	train has 567 instances.

The number of tokens in tokenizer  50265
50275 50280
cpu
11.3
input fields after batch(if batch size is 2):
	tgt_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 34]) 
	src_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 56]) 
	first: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 56]) 
	src_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
	tgt_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
target fields after batch(if batch size is 2):
	entities: (1)type:numpy.ndarray (2)dtype:object, (3)shape:(2,) 
	tgt_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 34]) 
	target_span: (1)type:numpy.ndarray (2)dtype:object, (3)shape:(2,) 
	tgt_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 

training epochs started 2023-02-20-10-13-39-079547
logging training to fitlog
creating history dir
[0, 3, 5, 2, 7, 4, 1, 6]
Evaluate data in 49.4 seconds!
Evaluate data in 58.34 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=34.67, rec=26.290000000000003, pre=50.92, em=0.0132
Evaluation on dev at Epoch 11/80. Step:781/5680: 
Seq2SeqSpanMetric: f=39.0, rec=29.84, pre=56.269999999999996, em=0.0133

Evaluate data in 51.19 seconds!
Evaluation on dev at Epoch 12/80. Step:852/5680: 
Seq2SeqSpanMetric: f=38.690000000000005, rec=29.84, pre=55.02, em=0.0133

Evaluate data in 45.93 seconds!
Evaluate data in 54.24 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=37.22, rec=28.000000000000004, pre=55.47, em=0.0
Evaluation on dev at Epoch 13/80. Step:923/5680: 
Seq2SeqSpanMetric: f=41.410000000000004, rec=32.06, pre=58.46, em=0.0

Evaluate data in 52.07 seconds!
Evaluate data in 57.63 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=39.17, rec=30.669999999999998, pre=54.21, em=0.0132
Evaluation on dev at Epoch 14/80. Step:994/5680: 
Seq2SeqSpanMetric: f=46.97, rec=38.31, pre=60.699999999999996, em=0.0

Evaluate data in 46.06 seconds!
Evaluation on dev at Epoch 15/80. Step:1065/5680: 
Seq2SeqSpanMetric: f=39.68, rec=30.44, pre=56.98, em=0.04

Evaluate data in 54.07 seconds!
Evaluation on dev at Epoch 16/80. Step:1136/5680: 
Seq2SeqSpanMetric: f=45.26, rec=37.1, pre=58.040000000000006, em=0.0

Evaluate data in 51.8 seconds!
Evaluation on dev at Epoch 17/80. Step:1207/5680: 
Seq2SeqSpanMetric: f=45.86, rec=36.9, pre=60.6, em=0.0133

Evaluate data in 52.03 seconds!
Evaluation on dev at Epoch 18/80. Step:1278/5680: 
Seq2SeqSpanMetric: f=45.12, rec=37.3, pre=57.099999999999994, em=0.0133

Evaluate data in 52.84 seconds!
Evaluate data in 57.56 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=48.010000000000005, rec=40.19, pre=59.599999999999994, em=0.0132
Evaluation on dev at Epoch 19/80. Step:1349/5680: 
Seq2SeqSpanMetric: f=49.230000000000004, rec=41.94, pre=59.599999999999994, em=0.0133

Evaluate data in 44.91 seconds!
Evaluate data in 51.62 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=47.370000000000005, rec=38.67, pre=61.14000000000001, em=0.0132
Evaluation on dev at Epoch 20/80. Step:1420/5680: 
Seq2SeqSpanMetric: f=50.55, rec=41.730000000000004, pre=64.09, em=0.04

Evaluate data in 48.93 seconds!
Evaluation on dev at Epoch 21/80. Step:1491/5680: 
Seq2SeqSpanMetric: f=50.239999999999995, rec=41.94, pre=62.64999999999999, em=0.04

Evaluate data in 52.8 seconds!
Evaluation on dev at Epoch 22/80. Step:1562/5680: 
Seq2SeqSpanMetric: f=50.18, rec=43.35, pre=59.56, em=0.0133

Evaluate data in 54.76 seconds!
Evaluate data in 56.58 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=50.28, rec=42.67, pre=61.199999999999996, em=0.0395
Evaluation on dev at Epoch 23/80. Step:1633/5680: 
Seq2SeqSpanMetric: f=51.03, rec=44.96, pre=58.989999999999995, em=0.0267

Evaluate data in 57.45 seconds!
Evaluate data in 57.31 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=53.42, rec=46.86, pre=62.12, em=0.0526
Evaluation on dev at Epoch 24/80. Step:1704/5680: 
Seq2SeqSpanMetric: f=52.370000000000005, rec=46.77, pre=59.489999999999995, em=0.0267

Evaluate data in 48.66 seconds!
Evaluation on dev at Epoch 25/80. Step:1775/5680: 
Seq2SeqSpanMetric: f=51.64, rec=44.56, pre=61.39, em=0.04

Evaluate data in 53.43 seconds!
Evaluate data in 54.43 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=52.21, rec=44.95, pre=62.27, em=0.0526
Evaluation on dev at Epoch 26/80. Step:1846/5680: 
Seq2SeqSpanMetric: f=53.410000000000004, rec=46.57, pre=62.6, em=0.0533

Evaluate data in 52.78 seconds!
Evaluate data in 52.62 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=54.58, rec=48.19, pre=62.94, em=0.0658
Evaluation on dev at Epoch 27/80. Step:1917/5680: 
Seq2SeqSpanMetric: f=53.559999999999995, rec=48.59, pre=59.650000000000006, em=0.0267

Evaluate data in 54.92 seconds!
Evaluate data in 55.42 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=54.74, rec=49.519999999999996, pre=61.18, em=0.0658
Evaluation on dev at Epoch 28/80. Step:1988/5680: 
Seq2SeqSpanMetric: f=56.03, rec=52.019999999999996, pre=60.709999999999994, em=0.04

Evaluate data in 49.64 seconds!
Evaluation on dev at Epoch 29/80. Step:2059/5680: 
Seq2SeqSpanMetric: f=55.779999999999994, rec=49.6, pre=63.73, em=0.04

Evaluate data in 49.28 seconds!
Evaluation on dev at Epoch 30/80. Step:2130/5680: 
Seq2SeqSpanMetric: f=55.230000000000004, rec=50.0, pre=61.69, em=0.0267

Evaluate data in 48.22 seconds!
Evaluate data in 53.15 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=55.19, rec=49.14, pre=62.93, em=0.0921
Evaluation on dev at Epoch 31/80. Step:2201/5680: 
Seq2SeqSpanMetric: f=57.330000000000005, rec=52.019999999999996, pre=63.85999999999999, em=0.0533

Evaluate data in 48.52 seconds!
Evaluation on dev at Epoch 32/80. Step:2272/5680: 
Seq2SeqSpanMetric: f=55.54, rec=51.01, pre=60.96, em=0.0533

Evaluate data in 51.71 seconds!
Evaluation on dev at Epoch 33/80. Step:2343/5680: 
Seq2SeqSpanMetric: f=57.14, rec=52.42, pre=62.8, em=0.0533

Evaluate data in 54.64 seconds!
Evaluation on dev at Epoch 34/80. Step:2414/5680: 
Seq2SeqSpanMetric: f=56.989999999999995, rec=53.02, pre=61.59, em=0.0533

Evaluate data in 51.12 seconds!
Evaluate data in 53.99 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=57.32000000000001, rec=52.56999999999999, pre=63.01, em=0.1184
Evaluation on dev at Epoch 35/80. Step:2485/5680: 
Seq2SeqSpanMetric: f=57.64, rec=53.23, pre=62.86000000000001, em=0.0533

Evaluate data in 52.94 seconds!
Evaluation on dev at Epoch 36/80. Step:2556/5680: 
Seq2SeqSpanMetric: f=57.45, rec=53.63, pre=61.86000000000001, em=0.04

Evaluate data in 51.56 seconds!
Evaluation on dev at Epoch 37/80. Step:2627/5680: 
Seq2SeqSpanMetric: f=56.92, rec=51.81, pre=63.13999999999999, em=0.04

Evaluate data in 50.32 seconds!
Evaluate data in 50.59 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=57.410000000000004, rec=52.0, pre=64.08, em=0.0921
Evaluation on dev at Epoch 38/80. Step:2698/5680: 
Seq2SeqSpanMetric: f=59.160000000000004, rec=54.03, pre=65.36999999999999, em=0.0533

Evaluate data in 53.08 seconds!
Evaluation on dev at Epoch 39/80. Step:2769/5680: 
Seq2SeqSpanMetric: f=55.96, rec=51.61, pre=61.1, em=0.0667

Evaluate data in 49.26 seconds!
Evaluation on dev at Epoch 40/80. Step:2840/5680: 
Seq2SeqSpanMetric: f=56.74, rec=52.22, pre=62.11, em=0.0667

Evaluate data in 49.21 seconds!
Evaluation on dev at Epoch 41/80. Step:2911/5680: 
Seq2SeqSpanMetric: f=58.86, rec=55.24, pre=62.99, em=0.0667

Evaluate data in 49.27 seconds!
Evaluation on dev at Epoch 42/80. Step:2982/5680: 
Seq2SeqSpanMetric: f=57.05, rec=52.62, pre=62.29, em=0.08

Evaluate data in 52.07 seconds!
Evaluation on dev at Epoch 43/80. Step:3053/5680: 
Seq2SeqSpanMetric: f=58.620000000000005, rec=54.84, pre=62.96000000000001, em=0.0933

Evaluate data in 49.35 seconds!
Evaluation on dev at Epoch 44/80. Step:3124/5680: 
Seq2SeqSpanMetric: f=58.230000000000004, rec=54.230000000000004, pre=62.849999999999994, em=0.0667

Evaluate data in 50.27 seconds!
Evaluation on dev at Epoch 45/80. Step:3195/5680: 
Seq2SeqSpanMetric: f=58.709999999999994, rec=55.04, pre=62.9, em=0.0667

Evaluate data in 45.35 seconds!
Evaluation on dev at Epoch 46/80. Step:3266/5680: 
Seq2SeqSpanMetric: f=58.63, rec=54.44, pre=63.53, em=0.0667

Evaluate data in 47.29 seconds!
Evaluation on dev at Epoch 47/80. Step:3337/5680: 
Seq2SeqSpanMetric: f=58.84, rec=55.04, pre=63.190000000000005, em=0.08

Evaluate data in 46.64 seconds!
Evaluate data in 53.14 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=59.03, rec=54.48, pre=64.41, em=0.1184
Evaluation on dev at Epoch 48/80. Step:3408/5680: 
Seq2SeqSpanMetric: f=59.699999999999996, rec=55.85, pre=64.12, em=0.0667

Evaluate data in 47.7 seconds!
Evaluation on dev at Epoch 49/80. Step:3479/5680: 
Seq2SeqSpanMetric: f=59.64, rec=56.45, pre=63.21, em=0.08

Evaluate data in 46.38 seconds!
Evaluate data in 55.84 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=59.14, rec=56.379999999999995, pre=62.18, em=0.1184
Evaluation on dev at Epoch 50/80. Step:3550/5680: 
Seq2SeqSpanMetric: f=60.28, rec=57.06, pre=63.88, em=0.08

Evaluate data in 51.1 seconds!
Evaluate data in 55.03 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=60.3, rec=57.14, pre=63.83, em=0.1316
Evaluation on dev at Epoch 51/80. Step:3621/5680: 
Seq2SeqSpanMetric: f=60.39, rec=56.85, pre=64.38000000000001, em=0.0933

Evaluate data in 48.38 seconds!
Evaluate data in 53.25 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=61.12, rec=58.099999999999994, pre=64.48, em=0.1316
Evaluation on dev at Epoch 52/80. Step:3692/5680: 
Seq2SeqSpanMetric: f=60.9, rec=57.46, pre=64.77000000000001, em=0.08

Evaluate data in 45.12 seconds!
Evaluation on dev at Epoch 53/80. Step:3763/5680: 
Seq2SeqSpanMetric: f=60.51, rec=57.46, pre=63.9, em=0.0667

Evaluate data in 44.53 seconds!
Evaluation on dev at Epoch 54/80. Step:3834/5680: 
Seq2SeqSpanMetric: f=59.830000000000005, rec=57.06, pre=62.89, em=0.08

Evaluate data in 48.82 seconds!
Evaluate data in 52.78 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=61.01, rec=57.52, pre=64.95, em=0.1316
Evaluation on dev at Epoch 55/80. Step:3905/5680: 
Seq2SeqSpanMetric: f=61.44, rec=58.47, pre=64.73, em=0.08

Evaluate data in 47.29 seconds!
Evaluation on dev at Epoch 56/80. Step:3976/5680: 
Seq2SeqSpanMetric: f=60.74, rec=57.86, pre=63.92, em=0.0933

Evaluate data in 49.94 seconds!
Evaluation on dev at Epoch 57/80. Step:4047/5680: 
Seq2SeqSpanMetric: f=61.029999999999994, rec=57.46, pre=65.07, em=0.12

Evaluate data in 46.17 seconds!
Evaluate data in 51.55 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=60.74, rec=57.9, pre=63.870000000000005, em=0.1184
Evaluation on dev at Epoch 58/80. Step:4118/5680: 
Seq2SeqSpanMetric: f=61.63999999999999, rec=58.47, pre=65.16999999999999, em=0.1067

Evaluate data in 42.09 seconds!
Evaluate data in 50.04 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=61.019999999999996, rec=56.95, pre=65.71000000000001, em=0.1184
Evaluation on dev at Epoch 59/80. Step:4189/5680: 
Seq2SeqSpanMetric: f=61.69, rec=58.269999999999996, pre=65.53, em=0.0933

Evaluate data in 44.54 seconds!
Evaluation on dev at Epoch 60/80. Step:4260/5680: 
Seq2SeqSpanMetric: f=61.309999999999995, rec=58.47, pre=64.44, em=0.08

Evaluate data in 49.01 seconds!
Evaluate data in 52.16 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=60.699999999999996, rec=58.099999999999994, pre=63.54, em=0.1184
Evaluation on dev at Epoch 61/80. Step:4331/5680: 
Seq2SeqSpanMetric: f=62.01, rec=59.07, pre=65.25999999999999, em=0.08

Evaluate data in 45.49 seconds!
Evaluation on dev at Epoch 62/80. Step:4402/5680: 
Seq2SeqSpanMetric: f=61.14000000000001, rec=59.48, pre=62.9, em=0.08

Evaluate data in 42.85 seconds!
Evaluation on dev at Epoch 63/80. Step:4473/5680: 
Seq2SeqSpanMetric: f=61.75000000000001, rec=58.269999999999996, pre=65.68, em=0.0933

Evaluate data in 44.67 seconds!
Evaluation on dev at Epoch 64/80. Step:4544/5680: 
Seq2SeqSpanMetric: f=61.77, rec=58.47, pre=65.46, em=0.08

Evaluate data in 42.42 seconds!
Evaluation on dev at Epoch 65/80. Step:4615/5680: 
Seq2SeqSpanMetric: f=61.419999999999995, rec=58.269999999999996, pre=64.94, em=0.08

Evaluate data in 49.69 seconds!
Evaluation on dev at Epoch 66/80. Step:4686/5680: 
Seq2SeqSpanMetric: f=61.73, rec=59.68, pre=63.93, em=0.08

Evaluate data in 48.36 seconds!
Evaluate data in 52.51 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=61.89, rec=59.24, pre=64.79, em=0.1184
Evaluation on dev at Epoch 67/80. Step:4757/5680: 
Seq2SeqSpanMetric: f=62.32, rec=59.68, pre=65.2, em=0.08

Evaluate data in 49.29 seconds!
Evaluation on dev at Epoch 68/80. Step:4828/5680: 
Seq2SeqSpanMetric: f=61.38, rec=58.47, pre=64.59, em=0.12

Evaluate data in 50.34 seconds!
Evaluate data in 53.21 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=61.980000000000004, rec=59.62, pre=64.53999999999999, em=0.1053
Evaluation on dev at Epoch 69/80. Step:4899/5680: 
Seq2SeqSpanMetric: f=62.529999999999994, rec=59.88, pre=65.42, em=0.12

Evaluate data in 46.35 seconds!
Evaluation on dev at Epoch 70/80. Step:4970/5680: 
Seq2SeqSpanMetric: f=61.3, rec=59.07, pre=63.7, em=0.0933

Evaluate data in 49.04 seconds!
Evaluation on dev at Epoch 71/80. Step:5041/5680: 
Seq2SeqSpanMetric: f=61.72, rec=58.67, pre=65.10000000000001, em=0.0933

Evaluate data in 48.74 seconds!
Evaluation on dev at Epoch 72/80. Step:5112/5680: 
Seq2SeqSpanMetric: f=61.029999999999994, rec=58.269999999999996, pre=64.08, em=0.0933

Evaluate data in 48.82 seconds!
Evaluation on dev at Epoch 73/80. Step:5183/5680: 
Seq2SeqSpanMetric: f=61.519999999999996, rec=58.67, pre=64.67, em=0.08

Evaluate data in 49.59 seconds!
Evaluation on dev at Epoch 74/80. Step:5254/5680: 
Seq2SeqSpanMetric: f=61.23, rec=59.07, pre=63.56, em=0.08

Evaluate data in 49.91 seconds!
Evaluation on dev at Epoch 75/80. Step:5325/5680: 
Seq2SeqSpanMetric: f=61.25000000000001, rec=59.27, pre=63.36000000000001, em=0.08

Evaluate data in 49.39 seconds!
Evaluation on dev at Epoch 76/80. Step:5396/5680: 
Seq2SeqSpanMetric: f=61.53999999999999, rec=58.87, pre=64.46, em=0.0933

Evaluate data in 49.79 seconds!
Evaluation on dev at Epoch 77/80. Step:5467/5680: 
Seq2SeqSpanMetric: f=61.760000000000005, rec=59.27, pre=64.47, em=0.08

Evaluate data in 49.53 seconds!
Evaluation on dev at Epoch 78/80. Step:5538/5680: 
Seq2SeqSpanMetric: f=62.11, rec=59.48, pre=64.98, em=0.08

Evaluate data in 49.3 seconds!
Evaluation on dev at Epoch 79/80. Step:5609/5680: 
Seq2SeqSpanMetric: f=61.91, rec=59.48, pre=64.55, em=0.08

Evaluate data in 49.09 seconds!
Evaluation on dev at Epoch 80/80. Step:5680/5680: 
Seq2SeqSpanMetric: f=61.89, rec=59.27, pre=64.75999999999999, em=0.08

Best test performance(may not correspond to the best dev performance):{'Seq2SeqSpanMetric': {'f': 61.980000000000004, 'rec': 59.62, 'pre': 64.53999999999999, 'em': 0.1053}} achieved at Epoch:69.
Best test performance(correspond to the best dev performance):{'Seq2SeqSpanMetric': {'f': 61.980000000000004, 'rec': 59.62, 'pre': 64.53999999999999, 'em': 0.1053}} achieved at Epoch:69.

In Epoch:69/Step:4899, got best dev performance:
Seq2SeqSpanMetric: f=62.529999999999994, rec=59.88, pre=65.42, em=0.12

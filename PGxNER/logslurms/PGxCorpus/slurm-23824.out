Running on sh06
# conda environments:
#
base                  *  /opt/conda
PGx_env                  /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/PGx_env
PGx_env_37               /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/PGx_env_37
clean_PGx_env            /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/clean_PGx_env
clean_PGx_env_latest_transformers     /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/clean_PGx_env_latest_transformers
cloned_env               /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/cloned_env
new_PGx_env              /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env
torch_from_source_env     /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/torch_from_source_env

Namespace(bart_name='facebook/bart-large', batch_size=8, dataset_name='PGxCorpus', decoder_type='avg_feature', eval_start_epoch=10, history_dir='./training_history', length_penalty=1, lr=1e-05, max_len=10, max_len_a=1.6, n_epochs=100, num_beams=3, save_model=1, schedule='linear', target_type='span', use_encoder_mlp=1, warmup_ratio=0.01)
{'dev': +--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| entities     | entity_tags     | raw_words     | entity_spans     | tgt_tokens     | target_span     | src_tokens     | first       | src_seq_len | tgt_seq_len |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| [['COMT']... | ['gene_or_pr... | ['The', 'C... | [[1, 2], [1, ... | [0, 14, 15,... | [[14, 15, 2]... | [0, 20, 158... | [0, 1, 2... | 29          | 17          |
| [['tumors... | ['disease', ... | ['One', 'p... | [[5, 6], [7, ... | [0, 18, 18,... | [[18, 18, 6]... | [0, 509, 31... | [0, 1, 2... | 66          | 50          |
| [['DRD', ... | ['gene_or_pr... | ['CONCLUSI... | [[2, 4], [2, ... | [0, 17, 19,... | [[17, 19, 2]... | [0, 8748, 2... | [0, 1, 2... | 33          | 17          |
| [['metabo... | ['chemical',... | ['To', 'id... | [[3, 6], [13,... | [0, 16, 18,... | [[16, 18, 4]... | [0, 598, 30... | [0, 1, 2... | 43          | 23          |
| [['cytoch... | ['gene_or_pr... | ['As', 'cy... | [[1, 4], [6, ... | [0, 14, 18,... | [[14, 18, 2]... | [0, 287, 19... | [0, 1, 2... | 47          | 20          |
| [['respon... | ['pharmacody... | ['The', 'r... | [[1, 3], [6, ... | [0, 14, 15,... | [[14, 15, 5]... | [0, 20, 126... | [0, 1, 2... | 26          | 17          |
| [['polymo... | ['limited_va... | ['With', '... | [[6, 11], [9,... | [0, 19, 25,... | [[19, 25, 3]... | [0, 590, 62... | [0, 1, 2... | 59          | 23          |
| [['GNB', ... | ['gene_or_pr... | ['Patients... | [[3, 5], [3, ... | [0, 16, 18,... | [[16, 18, 2]... | [0, 21755, ... | [0, 1, 2... | 43          | 14          |
| [['Sorafe... | ['chemical',... | ['Sorafeni... | [[0, 1], [8, ... | [0, 13, 16,... | [[13, 16, 4]... | [0, 14405, ... | [0, 1, 2... | 55          | 38          |
| [['Gastri... | ['disease', ... | ['CONCLUSI... | [[2, 4], [6, ... | [0, 17, 19,... | [[17, 19, 6]... | [0, 8748, 2... | [0, 1, 2... | 52          | 28          |
| [['Gly', ... | ['limited_va... | ['The', 'e... | [[4, 10], [7,... | [0, 17, 24,... | [[17, 24, 3]... | [0, 20, 303... | [0, 1, 2... | 33          | 25          |
| [['geneti... | ['limited_va... | ['This', '... | [[6, 13], [10... | [0, 19, 27,... | [[19, 27, 3]... | [0, 152, 89... | [0, 1, 2... | 33          | 20          |
| ...          | ...             | ...           | ...              | ...            | ...             | ...            | ...         | ...         | ...         |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+, 'test': +--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| entities     | entity_tags     | raw_words     | entity_spans     | tgt_tokens     | target_span     | src_tokens     | first       | src_seq_len | tgt_seq_len |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| [['alcoho... | ['chemical',... | ['Associat... | [[2, 3], [2, ... | [0, 15, 15,... | [[15, 15, 4]... | [0, 1544, 9... | [0, 1, 2... | 61          | 20          |
| [['GISTs'... | ['disease', ... | ['Most', '... | [[1, 2], [4, ... | [0, 14, 16,... | [[14, 16, 6]... | [0, 1993, 2... | [0, 1, 2... | 40          | 17          |
| [['angiot... | ['gene_or_pr... | ['The', 'a... | [[1, 7], [1, ... | [0, 14, 22,... | [[14, 22, 2]... | [0, 20, 566... | [0, 1, 2... | 50          | 23          |
| [['levels... | ['phenotype'... | ['The', 'l... | [[1, 6, 12, 1... | [0, 14, 19,... | [[14, 19, 28... | [0, 20, 138... | [0, 1, 2... | 55          | 50          |
| [['morphi... | ['chemical',... | ['Although... | [[1, 2], [1, ... | [0, 14, 14,... | [[14, 14, 4]... | [0, 2223, 3... | [0, 1, 2... | 29          | 22          |
| [['T', '1... | ['limited_va... | ['In', 'th... | [[9, 28], [15... | [0, 22, 43,... | [[22, 43, 3]... | [0, 96, 5, ... | [0, 1, 2... | 39          | 17          |
| [['respon... | ['pharmacody... | ['This', '... | [[5, 8], [5, ... | [0, 18, 23,... | [[18, 23, 5]... | [0, 152, 31... | [0, 1, 2... | 42          | 34          |
| [['AZ'], ... | ['chemical',... | ['However'... | [[9, 10], [12... | [0, 22, 22,... | [[22, 22, 4]... | [0, 635, 21... | [0, 1, 2... | 104         | 41          |
| [['lycope... | ['chemical',... | ['We', 'fo... | [[3, 4], [8, ... | [0, 16, 18,... | [[16, 18, 4]... | [0, 166, 30... | [0, 1, 2... | 36          | 25          |
| [['Cytoch... | ['gene_or_pr... | ['Cytochro... | [[0, 6], [0, ... | [0, 13, 20,... | [[13, 20, 2]... | [0, 9384, 5... | [0, 1, 2... | 45          | 28          |
| [['oral',... | ['pharmacoki... | ['We', 'fo... | [[2, 8], [5, ... | [0, 15, 22,... | [[15, 22, 10... | [0, 166, 30... | [0, 1, 2... | 62          | 17          |
| [['MDR', ... | ['gene_or_pr... | ['Is', 'th... | [[5, 7], [5, ... | [0, 18, 20,... | [[18, 20, 2]... | [0, 1534, 8... | [0, 1, 2... | 38          | 30          |
| ...          | ...             | ...           | ...              | ...            | ...             | ...            | ...         | ...         | ...         |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+, 'train': +--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| entities     | entity_tags     | raw_words     | entity_spans     | tgt_tokens     | target_span     | src_tokens     | first       | src_seq_len | tgt_seq_len |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+
| [['UGT', ... | ['gene_or_pr... | ['CONCLUSI... | [[5, 9], [5, ... | [0, 20, 24,... | [[20, 24, 2]... | [0, 8748, 2... | [0, 1, 2... | 40          | 28          |
| [['opioid... | ['chemical',... | ['Withdraw... | [[7, 9], [10,... | [0, 26, 27,... | [[26, 27, 4]... | [0, 590, 24... | [0, 1, 2... | 56          | 20          |
| [['effect... | ['pharmacody... | ['To', 'ad... | [[8, 15], [14... | [0, 21, 27,... | [[21, 27, 5]... | [0, 598, 11... | [0, 1, 2... | 53          | 20          |
| [['PDAC']... | ['disease', ... | ['Accordin... | [[2, 3], [7, ... | [0, 15, 16,... | [[15, 16, 6]... | [0, 29129, ... | [0, 1, 2... | 35          | 23          |
| [['nonres... | ['pharmacody... | ['One', 'o... | [[3, 4], [7, ... | [0, 16, 18,... | [[16, 18, 5]... | [0, 509, 9,... | [0, 1, 2... | 67          | 29          |
| [['Beta',... | ['gene_or_pr... | ['Beta', '... | [[0, 2], [0, ... | [0, 13, 14,... | [[13, 14, 2]... | [0, 25905, ... | [0, 1, 2... | 34          | 17          |
| [['multik... | ['chemical',... | ['Here', '... | [[6, 8], [8, ... | [0, 19, 23,... | [[19, 23, 4]... | [0, 1398, 2... | [0, 1, 2... | 56          | 20          |
| [['DPYD']... | ['gene_or_pr... | ['The', 'a... | [[6, 7], [6, ... | [0, 19, 20,... | [[19, 20, 2]... | [0, 20, 410... | [0, 1, 2... | 43          | 23          |
| [['JAK', ... | ['gene_or_pr... | ['The', 'J... | [[1, 3], [1, ... | [0, 14, 16,... | [[14, 16, 2]... | [0, 20, 344... | [0, 1, 2... | 74          | 29          |
| [['exons'... | ['genomic_fa... | ['METHODS'... | [[5, 9], [7, ... | [0, 21, 27,... | [[21, 27, 9]... | [0, 256, 40... | [0, 1, 2... | 43          | 14          |
| [['GSTT',... | ['gene_or_pr... | ['Particul... | [[4, 6], [4, ... | [0, 17, 19,... | [[17, 19, 2]... | [0, 36863, ... | [0, 1, 2... | 31          | 22          |
| [['CYP', ... | ['gene_or_pr... | ['The', 'e... | [[3, 7], [3, ... | [0, 16, 20,... | [[16, 20, 2]... | [0, 20, 303... | [0, 1, 2... | 31          | 17          |
| ...          | ...             | ...           | ...              | ...            | ...             | ...            | ...         | ...         | ...         |
+--------------+-----------------+---------------+------------------+----------------+-----------------+----------------+-------------+-------------+-------------+}
Save cache to caches/data_facebook/bart-large_PGxCorpus_span.pt.
max_len_a:1.6, max_len:10
In total 3 datasets:
	dev has 75 instances.
	test has 76 instances.
	train has 567 instances.

50275 50280
cpu
11.3
input fields after batch(if batch size is 2):
	tgt_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 28]) 
	src_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 56]) 
	first: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 56]) 
	src_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
	tgt_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
target fields after batch(if batch size is 2):
	entities: (1)type:numpy.ndarray (2)dtype:object, (3)shape:(2,) 
	tgt_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 28]) 
	target_span: (1)type:numpy.ndarray (2)dtype:object, (3)shape:(2,) 
	tgt_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 

training epochs started 2023-02-21-20-38-08-519236
logging training to fitlog
creating history dir
[0, 3, 20, 5, 16, 22, 2, 7, 17, 18, 21, 9, 10, 15, 14, 4, 0, 1, 13, 12, 11, 6, 8, 19]

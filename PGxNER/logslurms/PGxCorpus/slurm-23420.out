Running on sh04
# conda environments:
#
base                  *  /opt/conda
PGx_env                  /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/PGx_env
PGx_env_37               /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/PGx_env_37
new_PGx_env              /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env
torch_from_source_env     /usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/torch_from_source_env

[34mFitlog project has been initialized. [0m
Namespace(bart_name='facebook/bart-large', batch_size=8, dataset_name='PGxCorpus', decoder_type='avg_feature', eval_start_epoch=10, history_dir='./history', length_penalty=1, lr=1e-05, max_len=10, max_len_a=1.6, n_epochs=50, num_beams=4, save_model=1, schedule='linear', target_type='word', use_encoder_mlp=1, warmup_ratio=0.01)
Save cache to caches/data_facebook/bart-large_PGxCorpus_word.pt.
max_len_a:1.6, max_len:10
In total 3 datasets:
	dev has 75 instances.
	test has 76 instances.
	train has 567 instances.

The number of tokens in tokenizer  50265
50275 50280
cpu
11.3
input fields after batch(if batch size is 2):
	tgt_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 34]) 
	src_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 56]) 
	first: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 56]) 
	src_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
	tgt_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
target fields after batch(if batch size is 2):
	entities: (1)type:numpy.ndarray (2)dtype:object, (3)shape:(2,) 
	tgt_tokens: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 34]) 
	target_span: (1)type:numpy.ndarray (2)dtype:object, (3)shape:(2,) 
	tgt_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 

training epochs started 2023-02-17-18-12-05-341407
logging training to fitlog
Evaluate data in 64.19 seconds!
Evaluate data in 81.63 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=54.97, rec=48.949999999999996, pre=62.68, em=0.0658
Evaluation on dev at Epoch 11/50. Step:781/3550: 
Seq2SeqSpanMetric: f=54.300000000000004, rec=48.99, pre=60.9, em=0.0533

Evaluate data in 63.83 seconds!
Evaluate data in 88.09 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=55.19, rec=50.1, pre=61.45, em=0.0263
Evaluation on dev at Epoch 12/50. Step:852/3550: 
Seq2SeqSpanMetric: f=55.97, rec=51.01, pre=62.01, em=0.04

Evaluate data in 54.98 seconds!
Evaluate data in 70.65 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=59.62, rec=54.290000000000006, pre=66.13, em=0.0526
Evaluation on dev at Epoch 13/50. Step:923/3550: 
Seq2SeqSpanMetric: f=57.4, rec=52.42, pre=63.41, em=0.0667

Evaluate data in 61.46 seconds!
Evaluate data in 74.24 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=61.7, rec=56.76, pre=67.57, em=0.0658
Evaluation on dev at Epoch 14/50. Step:994/3550: 
Seq2SeqSpanMetric: f=59.540000000000006, rec=54.44, pre=65.69, em=0.1067

Evaluate data in 58.55 seconds!
Evaluate data in 69.1 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=61.550000000000004, rec=56.57, pre=67.5, em=0.0658
Evaluation on dev at Epoch 15/50. Step:1065/3550: 
Seq2SeqSpanMetric: f=60.61, rec=56.45, pre=65.42, em=0.0933

Evaluate data in 56.73 seconds!
Evaluate data in 77.1 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=62.17, rec=57.9, pre=67.11, em=0.0789
Evaluation on dev at Epoch 16/50. Step:1136/3550: 
Seq2SeqSpanMetric: f=61.82, rec=57.46, pre=66.9, em=0.1067

Evaluate data in 54.83 seconds!
Evaluate data in 74.44 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=60.17, rec=54.669999999999995, pre=66.9, em=0.0789
Evaluation on dev at Epoch 17/50. Step:1207/3550: 
Seq2SeqSpanMetric: f=62.28, rec=58.269999999999996, pre=66.9, em=0.12

Evaluate data in 57.37 seconds!
Evaluate data in 78.84 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=59.77, rec=55.620000000000005, pre=64.60000000000001, em=0.0658
Evaluation on dev at Epoch 18/50. Step:1278/3550: 
Seq2SeqSpanMetric: f=63.160000000000004, rec=59.27, pre=67.58999999999999, em=0.0933

Evaluate data in 57.54 seconds!
Evaluation on dev at Epoch 19/50. Step:1349/3550: 
Seq2SeqSpanMetric: f=62.339999999999996, rec=59.07, pre=65.99000000000001, em=0.12

Evaluate data in 56.64 seconds!
Evaluation on dev at Epoch 20/50. Step:1420/3550: 
Seq2SeqSpanMetric: f=62.849999999999994, rec=59.68, pre=66.36999999999999, em=0.12

Evaluate data in 61.71 seconds!
Evaluation on dev at Epoch 21/50. Step:1491/3550: 
Seq2SeqSpanMetric: f=63.09, rec=60.480000000000004, pre=65.93, em=0.12

Evaluate data in 56.24 seconds!
Evaluate data in 67.86 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=64.13, rec=60.95, pre=67.65, em=0.1053
Evaluation on dev at Epoch 22/50. Step:1562/3550: 
Seq2SeqSpanMetric: f=63.28, rec=60.28, pre=66.59, em=0.12

Evaluate data in 57.99 seconds!
Evaluation on dev at Epoch 23/50. Step:1633/3550: 
Seq2SeqSpanMetric: f=62.3, rec=59.48, pre=65.41, em=0.1467

Evaluate data in 56.72 seconds!
Evaluate data in 70.43 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=64.88000000000001, rec=62.1, pre=67.92, em=0.1053
Evaluation on dev at Epoch 24/50. Step:1704/3550: 
Seq2SeqSpanMetric: f=63.65, rec=60.89, pre=66.67, em=0.1467

Evaluate data in 57.82 seconds!
Evaluate data in 76.11 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=66.67, rec=64.0, pre=69.57, em=0.1316
Evaluation on dev at Epoch 25/50. Step:1775/3550: 
Seq2SeqSpanMetric: f=64.12, rec=62.5, pre=65.82000000000001, em=0.1067

Evaluate data in 62.05 seconds!
Evaluate data in 73.93 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=67.71000000000001, rec=65.71000000000001, pre=69.84, em=0.1316
Evaluation on dev at Epoch 26/50. Step:1846/3550: 
Seq2SeqSpanMetric: f=64.52, rec=62.5, pre=66.67, em=0.12

Evaluate data in 58.88 seconds!
Evaluate data in 82.46 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=66.60000000000001, rec=64.38000000000001, pre=68.97999999999999, em=0.1184
Evaluation on dev at Epoch 27/50. Step:1917/3550: 
Seq2SeqSpanMetric: f=65.27, rec=62.9, pre=67.83, em=0.1467

Evaluate data in 55.92 seconds!
Evaluate data in 71.29 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=67.06, rec=65.14, pre=69.08999999999999, em=0.1447
Evaluation on dev at Epoch 28/50. Step:1988/3550: 
Seq2SeqSpanMetric: f=65.28, rec=63.31, pre=67.38, em=0.1333

Evaluate data in 59.88 seconds!
Evaluate data in 68.22 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=64.18, rec=62.29, pre=66.19, em=0.1316
Evaluation on dev at Epoch 29/50. Step:2059/3550: 
Seq2SeqSpanMetric: f=65.63, rec=63.91, pre=67.45, em=0.1333

Evaluate data in 54.99 seconds!
Evaluation on dev at Epoch 30/50. Step:2130/3550: 
Seq2SeqSpanMetric: f=64.37, rec=62.3, pre=66.59, em=0.16

Evaluate data in 60.59 seconds!
Evaluate data in 68.11 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=66.60000000000001, rec=65.52, pre=67.72, em=0.1447
Evaluation on dev at Epoch 31/50. Step:2201/3550: 
Seq2SeqSpanMetric: f=67.01, rec=65.93, pre=68.12, em=0.1067

Evaluate data in 56.49 seconds!
Evaluation on dev at Epoch 32/50. Step:2272/3550: 
Seq2SeqSpanMetric: f=65.63, rec=64.11, pre=67.23, em=0.1333

Evaluate data in 57.16 seconds!
Evaluation on dev at Epoch 33/50. Step:2343/3550: 
Seq2SeqSpanMetric: f=66.86999999999999, rec=65.12, pre=68.72, em=0.12

Evaluate data in 56.3 seconds!
Evaluate data in 64.76 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=67.13, rec=64.19, pre=70.35, em=0.1579
Evaluation on dev at Epoch 34/50. Step:2414/3550: 
Seq2SeqSpanMetric: f=67.02, rec=64.52, pre=69.72, em=0.1467

Evaluate data in 62.79 seconds!
Evaluation on dev at Epoch 35/50. Step:2485/3550: 
Seq2SeqSpanMetric: f=65.57, rec=64.31, pre=66.88, em=0.1467

Evaluate data in 57.54 seconds!
Evaluation on dev at Epoch 36/50. Step:2556/3550: 
Seq2SeqSpanMetric: f=67.01, rec=65.93, pre=68.12, em=0.1467

Evaluate data in 58.99 seconds!
Evaluation on dev at Epoch 37/50. Step:2627/3550: 
Seq2SeqSpanMetric: f=66.94, rec=66.53, pre=67.35, em=0.1067

Evaluate data in 63.33 seconds!
Evaluate data in 79.98 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=67.64, rec=66.10000000000001, pre=69.26, em=0.1447
Evaluation on dev at Epoch 38/50. Step:2698/3550: 
Seq2SeqSpanMetric: f=67.21000000000001, rec=65.93, pre=68.55, em=0.16

Evaluate data in 56.44 seconds!
Evaluation on dev at Epoch 39/50. Step:2769/3550: 
Seq2SeqSpanMetric: f=67.21000000000001, rec=66.33, pre=68.12, em=0.16

Evaluate data in 56.81 seconds!
Evaluation on dev at Epoch 40/50. Step:2840/3550: 
Seq2SeqSpanMetric: f=66.94, rec=66.33, pre=67.56, em=0.1067

Evaluate data in 59.54 seconds!
Evaluate data in 78.02 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=68.67999999999999, rec=67.24, pre=70.17999999999999, em=0.1579
Evaluation on dev at Epoch 41/50. Step:2911/3550: 
Seq2SeqSpanMetric: f=67.28, rec=66.53, pre=68.04, em=0.1067

Evaluate data in 54.56 seconds!
Evaluation on dev at Epoch 42/50. Step:2982/3550: 
Seq2SeqSpanMetric: f=66.67, rec=65.32, pre=68.07, em=0.1467

Evaluate data in 57.81 seconds!
Evaluation on dev at Epoch 43/50. Step:3053/3550: 
Seq2SeqSpanMetric: f=66.67, rec=65.32, pre=68.07, em=0.1333

Evaluate data in 58.74 seconds!
Evaluate data in 75.3 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=68.47999999999999, rec=67.24, pre=69.76, em=0.1447
Evaluation on dev at Epoch 44/50. Step:3124/3550: 
Seq2SeqSpanMetric: f=67.47999999999999, rec=66.94, pre=68.03, em=0.1067

Evaluate data in 55.59 seconds!
Evaluation on dev at Epoch 45/50. Step:3195/3550: 
Seq2SeqSpanMetric: f=67.42, rec=66.53, pre=68.32000000000001, em=0.1333

Evaluate data in 57.8 seconds!
Evaluate data in 65.7 seconds!
FitlogCallback evaluation on data-test:
Seq2SeqSpanMetric: f=68.28999999999999, rec=66.86, pre=69.78, em=0.1447
Evaluation on dev at Epoch 46/50. Step:3266/3550: 
Seq2SeqSpanMetric: f=67.62, rec=66.73, pre=68.53, em=0.1467

Evaluate data in 57.65 seconds!
Evaluation on dev at Epoch 47/50. Step:3337/3550: 
Seq2SeqSpanMetric: f=67.42, rec=66.53, pre=68.32000000000001, em=0.1467

Evaluate data in 57.92 seconds!
Evaluation on dev at Epoch 48/50. Step:3408/3550: 
Seq2SeqSpanMetric: f=67.42, rec=66.53, pre=68.32000000000001, em=0.1467

Evaluate data in 57.68 seconds!
Evaluation on dev at Epoch 49/50. Step:3479/3550: 
Seq2SeqSpanMetric: f=67.41, rec=66.94, pre=67.89, em=0.1467

Evaluate data in 58.06 seconds!
Evaluation on dev at Epoch 50/50. Step:3550/3550: 
Seq2SeqSpanMetric: f=67.14, rec=66.73, pre=67.55, em=0.1467

Best test performance(may not correspond to the best dev performance):{'Seq2SeqSpanMetric': {'f': 68.67999999999999, 'rec': 67.24, 'pre': 70.17999999999999, 'em': 0.1579}} achieved at Epoch:41.
Best test performance(correspond to the best dev performance):{'Seq2SeqSpanMetric': {'f': 68.28999999999999, 'rec': 66.86, 'pre': 69.78, 'em': 0.1447}} achieved at Epoch:46.

In Epoch:46/Step:3266, got best dev performance:
Seq2SeqSpanMetric: f=67.62, rec=66.73, pre=68.53, em=0.1467
This server will automatically shutdown if no api access for 48 hours.
Start preparing data...

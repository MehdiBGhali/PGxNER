pre. tgt. for `dev`:   0%|          | 0/1097 [00:00<?, ?it/s]pre. tgt. for `dev`:  14%|█▍        | 151/1097 [00:00<00:00, 1508.96it/s]pre. tgt. for `dev`:  30%|██▉       | 328/1097 [00:00<00:00, 1662.29it/s]pre. tgt. for `dev`:  46%|████▌     | 505/1097 [00:00<00:00, 1708.75it/s]pre. tgt. for `dev`:  63%|██████▎   | 692/1097 [00:00<00:00, 1769.95it/s]pre. tgt. for `dev`:  80%|███████▉  | 877/1097 [00:00<00:00, 1790.11it/s]pre. tgt. for `dev`:  97%|█████████▋| 1065/1097 [00:00<00:00, 1816.15it/s]                                                                          pre. tgt. for `test`:   0%|          | 0/1160 [00:00<?, ?it/s]pre. tgt. for `test`:  17%|█▋        | 200/1160 [00:00<00:00, 1994.91it/s]pre. tgt. for `test`:  34%|███▍      | 400/1160 [00:00<00:00, 1934.60it/s]pre. tgt. for `test`:  51%|█████▏    | 597/1160 [00:00<00:00, 1945.05it/s]pre. tgt. for `test`:  68%|██████▊   | 792/1160 [00:00<00:00, 1922.55it/s]pre. tgt. for `test`:  85%|████████▍ | 985/1160 [00:00<00:00, 1846.41it/s]                                                                          pre. tgt. for `train`:   0%|          | 0/5340 [00:00<?, ?it/s]pre. tgt. for `train`:   4%|▎         | 188/5340 [00:00<00:02, 1874.28it/s]pre. tgt. for `train`:   7%|▋         | 376/5340 [00:00<00:02, 1804.88it/s]pre. tgt. for `train`:  10%|█         | 557/5340 [00:00<00:02, 1776.35it/s]pre. tgt. for `train`:  14%|█▍        | 752/5340 [00:00<00:02, 1838.69it/s]pre. tgt. for `train`:  18%|█▊        | 947/5340 [00:00<00:02, 1877.32it/s]pre. tgt. for `train`:  21%|██▏       | 1135/5340 [00:00<00:02, 1854.58it/s]pre. tgt. for `train`:  25%|██▍       | 1331/5340 [00:00<00:02, 1887.35it/s]pre. tgt. for `train`:  28%|██▊       | 1520/5340 [00:00<00:02, 1846.53it/s]pre. tgt. for `train`:  32%|███▏      | 1709/5340 [00:00<00:01, 1852.81it/s]pre. tgt. for `train`:  36%|███▌      | 1897/5340 [00:01<00:01, 1860.12it/s]pre. tgt. for `train`:  39%|███▉      | 2105/5340 [00:01<00:01, 1926.30it/s]pre. tgt. for `train`:  43%|████▎     | 2298/5340 [00:01<00:01, 1906.97it/s]pre. tgt. for `train`:  47%|████▋     | 2502/5340 [00:01<00:01, 1946.06it/s]pre. tgt. for `train`:  51%|█████     | 2718/5340 [00:01<00:01, 2006.72it/s]pre. tgt. for `train`:  55%|█████▍    | 2919/5340 [00:01<00:01, 1990.16it/s]pre. tgt. for `train`:  58%|█████▊    | 3119/5340 [00:01<00:01, 1924.29it/s]pre. tgt. for `train`:  62%|██████▏   | 3332/5340 [00:01<00:01, 1983.88it/s]pre. tgt. for `train`:  66%|██████▌   | 3531/5340 [00:01<00:00, 1876.42it/s]pre. tgt. for `train`:  70%|███████   | 3741/5340 [00:01<00:00, 1939.39it/s]pre. tgt. for `train`:  74%|███████▎  | 3938/5340 [00:02<00:00, 1947.10it/s]pre. tgt. for `train`:  77%|███████▋  | 4134/5340 [00:02<00:00, 1922.82it/s]pre. tgt. for `train`:  81%|████████▏ | 4345/5340 [00:02<00:00, 1974.40it/s]pre. tgt. for `train`:  85%|████████▌ | 4544/5340 [00:02<00:00, 1912.25it/s]pre. tgt. for `train`:  89%|████████▊ | 4737/5340 [00:02<00:00, 1886.98it/s]pre. tgt. for `train`:  92%|█████████▏| 4936/5340 [00:02<00:00, 1916.19it/s]pre. tgt. for `train`:  96%|█████████▌| 5139/5340 [00:02<00:00, 1947.19it/s]pre. tgt. for `train`: 100%|█████████▉| 5335/5340 [00:02<00:00, 1921.29it/s]                                                                            Traceback (most recent call last):
  File "./BARTNER/train.py", line 313, in <module>
    trainer = Trainer(train_data=ds, model=model, optimizer=optimizer,
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/trainer.py", line 559, in __init__
    _check_code(dataset=train_data, model=self.model, losser=losser, forward_func=self._forward_func, metrics=metrics,
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/trainer.py", line 982, in _check_code
    pred_dict = model(**refined_batch_x)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/generater.py", line 60, in forward
    return self.seq2seq_model(src_tokens, tgt_tokens, src_seq_len, tgt_seq_len, first)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/bart.py", line 281, in forward
    state = self.prepare_state(src_tokens, src_seq_len, first, tgt_seq_len)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/bart.py", line 265, in prepare_state
    encoder_outputs, encoder_mask, hidden_states = self.encoder(src_tokens, src_seq_len)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/bart.py", line 19, in forward
    mask = seq_len_to_mask(src_seq_len, max_len=src_tokens.size(1))
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/utils.py", line 862, in seq_len_to_mask
    mask = broad_cast_seq_len.lt(seq_len.unsqueeze(1))
RuntimeError: CUDA error: no kernel image is available for execution on the device

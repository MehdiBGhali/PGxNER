pre. tgt. for `dev`:   0%|          | 0/1097 [00:00<?, ?it/s]pre. tgt. for `dev`:  13%|█▎        | 144/1097 [00:00<00:00, 1437.65it/s]pre. tgt. for `dev`:  29%|██▉       | 318/1097 [00:00<00:00, 1612.75it/s]pre. tgt. for `dev`:  45%|████▌     | 498/1097 [00:00<00:00, 1689.90it/s]pre. tgt. for `dev`:  62%|██████▏   | 680/1097 [00:00<00:00, 1738.79it/s]pre. tgt. for `dev`:  79%|███████▊  | 863/1097 [00:00<00:00, 1767.48it/s]pre. tgt. for `dev`:  95%|█████████▌| 1045/1097 [00:00<00:00, 1780.95it/s]                                                                          pre. tgt. for `test`:   0%|          | 0/1160 [00:00<?, ?it/s]pre. tgt. for `test`:  17%|█▋        | 197/1160 [00:00<00:00, 1967.95it/s]pre. tgt. for `test`:  34%|███▍      | 394/1160 [00:00<00:00, 1913.32it/s]pre. tgt. for `test`:  51%|█████     | 588/1160 [00:00<00:00, 1924.36it/s]pre. tgt. for `test`:  67%|██████▋   | 781/1160 [00:00<00:00, 1898.74it/s]pre. tgt. for `test`:  84%|████████▎ | 971/1160 [00:00<00:00, 1809.23it/s]pre. tgt. for `test`: 100%|██████████| 1160/1160 [00:00<00:00, 1835.13it/s]                                                                           pre. tgt. for `train`:   0%|          | 0/5340 [00:00<?, ?it/s]pre. tgt. for `train`:   3%|▎         | 183/5340 [00:00<00:02, 1828.31it/s]pre. tgt. for `train`:   7%|▋         | 366/5340 [00:00<00:02, 1756.07it/s]pre. tgt. for `train`:  10%|█         | 542/5340 [00:00<00:02, 1741.74it/s]pre. tgt. for `train`:  14%|█▎        | 724/5340 [00:00<00:02, 1771.43it/s]pre. tgt. for `train`:  17%|█▋        | 907/5340 [00:00<00:02, 1791.09it/s]pre. tgt. for `train`:  20%|██        | 1092/5340 [00:00<00:02, 1806.68it/s]pre. tgt. for `train`:  24%|██▍       | 1273/5340 [00:00<00:02, 1794.29it/s]pre. tgt. for `train`:  27%|██▋       | 1454/5340 [00:00<00:02, 1798.15it/s]pre. tgt. for `train`:  31%|███       | 1642/5340 [00:00<00:02, 1821.84it/s]pre. tgt. for `train`:  34%|███▍      | 1825/5340 [00:01<00:01, 1761.44it/s]pre. tgt. for `train`:  38%|███▊      | 2034/5340 [00:01<00:01, 1859.12it/s]pre. tgt. for `train`:  42%|████▏     | 2243/5340 [00:01<00:01, 1927.35it/s]pre. tgt. for `train`:  46%|████▌     | 2437/5340 [00:01<00:01, 1911.89it/s]pre. tgt. for `train`:  49%|████▉     | 2641/5340 [00:01<00:01, 1949.14it/s]pre. tgt. for `train`:  53%|█████▎    | 2847/5340 [00:01<00:01, 1981.75it/s]pre. tgt. for `train`:  57%|█████▋    | 3046/5340 [00:01<00:01, 1886.26it/s]pre. tgt. for `train`:  61%|██████    | 3262/5340 [00:01<00:01, 1962.59it/s]pre. tgt. for `train`:  65%|██████▍   | 3460/5340 [00:01<00:01, 1857.95it/s]pre. tgt. for `train`:  69%|██████▊   | 3660/5340 [00:01<00:00, 1897.15it/s]pre. tgt. for `train`:  72%|███████▏  | 3854/5340 [00:02<00:00, 1909.31it/s]pre. tgt. for `train`:  76%|███████▌  | 4054/5340 [00:02<00:00, 1934.25it/s]pre. tgt. for `train`:  80%|███████▉  | 4249/5340 [00:02<00:00, 1897.58it/s]pre. tgt. for `train`:  83%|████████▎ | 4446/5340 [00:02<00:00, 1918.48it/s]pre. tgt. for `train`:  87%|████████▋ | 4639/5340 [00:02<00:00, 1810.65it/s]pre. tgt. for `train`:  90%|█████████ | 4828/5340 [00:02<00:00, 1832.87it/s]pre. tgt. for `train`:  94%|█████████▍| 5041/5340 [00:02<00:00, 1917.73it/s]pre. tgt. for `train`:  98%|█████████▊| 5234/5340 [00:02<00:00, 1874.58it/s]                                                                            Traceback (most recent call last):
  File "./BARTNER/train.py", line 313, in <module>
    trainer = Trainer(train_data=ds, model=model, optimizer=optimizer,
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/trainer.py", line 559, in __init__
    _check_code(dataset=train_data, model=self.model, losser=losser, forward_func=self._forward_func, metrics=metrics,
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/trainer.py", line 982, in _check_code
    pred_dict = model(**refined_batch_x)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/generater.py", line 60, in forward
    return self.seq2seq_model(src_tokens, tgt_tokens, src_seq_len, tgt_seq_len, first)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/bart.py", line 281, in forward
    state = self.prepare_state(src_tokens, src_seq_len, first, tgt_seq_len)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/bart.py", line 265, in prepare_state
    encoder_outputs, encoder_mask, hidden_states = self.encoder(src_tokens, src_seq_len)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/bart.py", line 19, in forward
    mask = seq_len_to_mask(src_seq_len, max_len=src_tokens.size(1))
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/utils.py", line 862, in seq_len_to_mask
    mask = broad_cast_seq_len.lt(seq_len.unsqueeze(1))
RuntimeError: CUDA error: no kernel image is available for execution on the device

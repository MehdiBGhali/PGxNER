pre. tgt. for `dev`:   0%|          | 0/1097 [00:00<?, ?it/s]pre. tgt. for `dev`:  14%|█▎        | 150/1097 [00:00<00:00, 1489.26it/s]pre. tgt. for `dev`:  30%|██▉       | 325/1097 [00:00<00:00, 1641.99it/s]pre. tgt. for `dev`:  46%|████▌     | 501/1097 [00:00<00:00, 1691.93it/s]pre. tgt. for `dev`:  62%|██████▏   | 683/1097 [00:00<00:00, 1738.96it/s]pre. tgt. for `dev`:  79%|███████▉  | 867/1097 [00:00<00:00, 1773.38it/s]pre. tgt. for `dev`:  96%|█████████▌| 1048/1097 [00:00<00:00, 1784.04it/s]                                                                          pre. tgt. for `test`:   0%|          | 0/1160 [00:00<?, ?it/s]pre. tgt. for `test`:  17%|█▋        | 199/1160 [00:00<00:00, 1989.82it/s]pre. tgt. for `test`:  34%|███▍      | 398/1160 [00:00<00:00, 1941.04it/s]pre. tgt. for `test`:  51%|█████     | 593/1160 [00:00<00:00, 1929.17it/s]pre. tgt. for `test`:  68%|██████▊   | 786/1160 [00:00<00:00, 1902.32it/s]pre. tgt. for `test`:  84%|████████▍ | 977/1160 [00:00<00:00, 1814.02it/s]                                                                          pre. tgt. for `train`:   0%|          | 0/5340 [00:00<?, ?it/s]pre. tgt. for `train`:   3%|▎         | 183/5340 [00:00<00:02, 1825.38it/s]pre. tgt. for `train`:   7%|▋         | 366/5340 [00:00<00:02, 1763.27it/s]pre. tgt. for `train`:  10%|█         | 543/5340 [00:00<00:02, 1762.75it/s]pre. tgt. for `train`:  14%|█▎        | 730/5340 [00:00<00:02, 1802.49it/s]pre. tgt. for `train`:  17%|█▋        | 923/5340 [00:00<00:02, 1847.56it/s]pre. tgt. for `train`:  21%|██        | 1108/5340 [00:00<00:02, 1843.45it/s]pre. tgt. for `train`:  24%|██▍       | 1293/5340 [00:00<00:02, 1822.87it/s]pre. tgt. for `train`:  28%|██▊       | 1477/5340 [00:00<00:02, 1827.61it/s]pre. tgt. for `train`:  31%|███       | 1663/5340 [00:00<00:02, 1835.45it/s]pre. tgt. for `train`:  35%|███▍      | 1847/5340 [00:01<00:01, 1786.16it/s]pre. tgt. for `train`:  38%|███▊      | 2053/5340 [00:01<00:01, 1866.56it/s]pre. tgt. for `train`:  42%|████▏     | 2259/5340 [00:01<00:01, 1916.58it/s]pre. tgt. for `train`:  46%|████▌     | 2459/5340 [00:01<00:01, 1928.25it/s]pre. tgt. for `train`:  50%|████▉     | 2666/5340 [00:01<00:01, 1969.66it/s]pre. tgt. for `train`:  54%|█████▎    | 2867/5340 [00:01<00:01, 1978.55it/s]pre. tgt. for `train`:  57%|█████▋    | 3066/5340 [00:01<00:01, 1871.66it/s]pre. tgt. for `train`:  62%|██████▏   | 3286/5340 [00:01<00:01, 1963.70it/s]pre. tgt. for `train`:  65%|██████▌   | 3484/5340 [00:01<00:00, 1865.85it/s]pre. tgt. for `train`:  69%|██████▉   | 3694/5340 [00:01<00:00, 1931.04it/s]pre. tgt. for `train`:  73%|███████▎  | 3889/5340 [00:02<00:00, 1912.47it/s]pre. tgt. for `train`:  76%|███████▋  | 4082/5340 [00:02<00:00, 1914.77it/s]pre. tgt. for `train`:  80%|████████  | 4277/5340 [00:02<00:00, 1922.92it/s]pre. tgt. for `train`:  84%|████████▍ | 4477/5340 [00:02<00:00, 1943.86it/s]pre. tgt. for `train`:  87%|████████▋ | 4672/5340 [00:02<00:00, 1844.10it/s]pre. tgt. for `train`:  91%|█████████ | 4868/5340 [00:02<00:00, 1873.66it/s]pre. tgt. for `train`:  95%|█████████▌| 5078/5340 [00:02<00:00, 1938.45it/s]pre. tgt. for `train`:  99%|█████████▉| 5275/5340 [00:02<00:00, 1944.33it/s]                                                                            Traceback (most recent call last):
  File "./BARTNER/train.py", line 313, in <module>
    trainer = Trainer(train_data=ds, model=model, optimizer=optimizer,
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/trainer.py", line 559, in __init__
    _check_code(dataset=train_data, model=self.model, losser=losser, forward_func=self._forward_func, metrics=metrics,
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/trainer.py", line 982, in _check_code
    pred_dict = model(**refined_batch_x)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/generater.py", line 60, in forward
    return self.seq2seq_model(src_tokens, tgt_tokens, src_seq_len, tgt_seq_len, first)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/bart.py", line 281, in forward
    state = self.prepare_state(src_tokens, src_seq_len, first, tgt_seq_len)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/bart.py", line 265, in prepare_state
    encoder_outputs, encoder_mask, hidden_states = self.encoder(src_tokens, src_seq_len)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.conda/envs/new_PGx_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/PGxNER/BARTNER/model/bart.py", line 19, in forward
    mask = seq_len_to_mask(src_seq_len, max_len=src_tokens.size(1))
  File "/usr/users/rattrapagemehdibenghali/benghali_meh/.local/lib/python3.8/site-packages/fastNLP/core/utils.py", line 862, in seq_len_to_mask
    mask = broad_cast_seq_len.lt(seq_len.unsqueeze(1))
RuntimeError: CUDA error: no kernel image is available for execution on the device
